node {
  stage('SCM Checkout & cloning'){
    
       git url:  'https://github.com/gunjannn/c-i.git',branch: 'master'
      
   }
	
    stage('git clone'){
        git clone 'https://github.com/gunjannn/c-i.git'
   }
	
	  stage('Terraform Repo') {
   
        sh "cd /var/lib/jenkins/workspace/c-i"
      }
      stage(Terraform init){
	sh "terraform init -input=false"
      }
    
    stage('Terraform Plan') {
     
        sh "terraform plan -out=tfplan -input=false -var-file='terraform.tfvars'"
      }
    
	stage('Inspec Testing') {
	
	    sh "inspec exec AKS -t azure://${subscription id}"
	  }
	
	/*stage('test outcome')
	  steps {
	    sh "./infra-testing.sh"
	*/	
	stage('Terraform Apply') {
   
        sh "terraform apply -input=false tfplan"
      }
    
}
